{"map":{"version":3,"sources":["static/js/main.c16c8f58.chunk.js"],"names":["this","push","14","module","__webpack_exports__","__webpack_require__","r","react","react_default","n","react_dom","react_dom_default","slicedToArray","regenerator","regenerator_default","asyncToGenerator","classCallCheck","createClass","defaultIceServers","iceServers","urls","webRTCRefactor_connHandler","connHandler","Object","socket","WebSocket","window","location","hostname","peerConnection","RTCPeerConnection","listener","conn","startUserMedia","_startStream","a","mark","_callee","video","wrap","_context","prev","next","navigator","mediaDevices","getUserMedia","sent","addTrack","stop","apply","arguments","key","value","_this","createOffer","then","d","setLocalDescription","startListener","sendIceCandidates","console","log","newListener","onmessage","event","message","JSON","parse","data","sdp","receiveOffer","candidate","receiveICECandidate","setRemoteDescription","RTCSessionDescription","isOffer","sendAnswer","e","createAnswer","answer","send","addIceCandidate","_this2","onicecandidate","isOpen","payload","stringify","readyState","OPEN","remoteDescription","type","UserMedia","_useState","_useState2","stream","setStream","negotiate","Camera","current","srcObject","play","createElement","Fragment","ref","width","height","autoPlay","App_element","App","rootElement","document","getElementById","render","8","exports"],"mappings":"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"},"code":"(this.webpackJsonpnew=this.webpackJsonpnew||[]).push([[0],{14:function(e,n,t){\"use strict\";t.r(n);var r=t(0),i=t.n(r),s=t(3),o=t.n(s),a=t(7),c=t(1),u=t.n(c),d=t(4),l=t(5),f=t(6);var h={iceServers:[{urls:\"stun:stun.l.google.com:19302\"}]},v=function(){function e(){Object(l.a)(this,e),this.socket=new WebSocket(\"ws://\"+window.location.hostname+\":8050/ws\"),this.peerConnection=new RTCPeerConnection(h),this.listener=null;var n=this;this.startUserMedia=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0});case 2:t=e.sent,n.peerConnection.addTrack(t);case 4:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}return Object(f.a)(e,[{key:\"negotiate\",value:function(){var e=this;this.peerConnection.createOffer().then((function(n){return e.peerConnection.setLocalDescription(n)})).then(this.startListener()).then(this.startUserMedia()).then(this.sendIceCandidates())}},{key:\"startListener\",value:function(){console.log(\"startListener\"),this.listener=this.newListener()}},{key:\"newListener\",value:function(){console.log(\"newListener\");var e=this;this.socket.onmessage=function(n){var t=JSON.parse(n.data);t.sdp?e.receiveOffer(t):t.candidate&&e.receiveICECandidate(t)}}},{key:\"receiveOffer\",value:function(e){console.log(\"receiveOffer\");var n=this;this.peerConnection.setRemoteDescription(new RTCSessionDescription(e),(function(){n.isOffer()&&n.sendAnswer()}),(function(e){return console.log(e)}))}},{key:\"sendAnswer\",value:function(){console.log(\"sendAnswer\");var e=this;e.peerConnection.createAnswer().then((function(n){return e.send(n),e.peerConnection.setLocalDescription(n)}))}},{key:\"addUserMedia\",value:function(){console.log(\"addUserMedia\"),this.startUserMedia()}},{key:\"receiveICECandidate\",value:function(e){console.log(\"receiveICEcandidate\"),this.peerConnection.addIceCandidate(e)}},{key:\"sendIceCandidates\",value:function(){var e=this;return console.log(\"sendIceCandidate\"),this.peerConnection.onicecandidate=function(n){e.isOpen()&&null!=n.candidate&&e.send(n.candidate)}}},{key:\"send\",value:function(e){console.log(\"send: \",e),this.socket.send(JSON.stringify(e))}},{key:\"isOpen\",value:function(){return this.socket.readyState==WebSocket.OPEN}},{key:\"isOffer\",value:function(){return\"offer\"==this.peerConnection.remoteDescription.type}},{key:\"isAnswer\",value:function(){return\"answer\"==this.peerConnection.remoteDescription.type}}]),e}();function p(){var e=Object(r.useState)(null),n=Object(a.a)(e,2),t=n[0],i=n[1];return Object(r.useEffect)((function(){i(void(new v).negotiate())}),[]),t}function w(){var e=Object(r.useRef)(),n=p();return n&&e.current&&(e.current.srcObject=n,e.current.play()),i.a.createElement(i.a.Fragment,null,i.a.createElement(\"video\",{ref:e,width:\"640\",height:\"480\",autoPlay:!0}))}var C=i.a.createElement(w,null);function k(){return C}var g=document.getElementById(\"root\");o.a.render(i.a.createElement(k,null),g)},8:function(e,n,t){e.exports=t(14)}},[[8,1,2]]]);","extractedComments":[]}