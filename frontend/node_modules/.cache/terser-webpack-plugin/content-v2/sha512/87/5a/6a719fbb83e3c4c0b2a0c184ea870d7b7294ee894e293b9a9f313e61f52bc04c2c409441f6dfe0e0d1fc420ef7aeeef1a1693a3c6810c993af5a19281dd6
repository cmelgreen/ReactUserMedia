{"map":{"version":3,"sources":["static/js/main.7583d798.chunk.js"],"names":["this","push","10","module","exports","__webpack_require__","16","__webpack_exports__","r","react","react_default","n","react_dom","react_dom_default","slicedToArray","regenerator","regenerator_default","createForOfIteratorHelper","asyncToGenerator","classCallCheck","createClass","defaultIceServers","iceServers","urls","webRTCRefactor_connHandler","connHandler","Object","socket","WebSocket","window","location","hostname","peerConnection","RTCPeerConnection","listener","conn","startUserMedia","_startStream","a","mark","_callee","video","_iterator","_step","wrap","_context","prev","next","navigator","mediaDevices","getUserMedia","sent","stream","getVideoTracks","s","done","track","value","addTrack","err","e","f","stop","apply","arguments","key","_this","createOffer","then","d","setLocalDescription","startListener","sendIceCandidates","console","log","newListener","onmessage","event","message","JSON","parse","data","sdp","receiveOffer","candidate","receiveICECandidate","setRemoteDescription","RTCSessionDescription","isOffer","sendAnswer","createAnswer","answer","send","addIceCandidate","_this2","onicecandidate","isOpen","payload","stringify","readyState","OPEN","remoteDescription","type","UserMedia","_useState","_useState2","setStream","negotiate","Camera","current","srcObject","play","createElement","Fragment","ref","width","height","autoPlay","App_element","App","rootElement","document","getElementById","render"],"mappings":"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"},"code":"(this.webpackJsonpnew=this.webpackJsonpnew||[]).push([[0],{10:function(e,n,t){e.exports=t(16)},16:function(e,n,t){\"use strict\";t.r(n);var r=t(0),i=t.n(r),s=t(4),o=t.n(s),a=t(9),c=t(2),u=t.n(c),d=t(5),l=t(6),f=t(7),v=t(8);var h={iceServers:[{urls:\"stun:stun.l.google.com:19302\"}]},p=function(){function e(){Object(f.a)(this,e),this.socket=new WebSocket(\"ws://\"+window.location.hostname+\":8050/ws\"),this.peerConnection=new RTCPeerConnection(h),this.listener=null;var n=this;this.startUserMedia=function(){var e=Object(l.a)(u.a.mark((function e(){var t,r,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0});case 2:t=e.sent,stream=t.getVideoTracks(),r=Object(d.a)(stream);try{for(r.s();!(i=r.n()).done;)track=i.value,n.peerConnection.addTrack(track,stream)}catch(s){r.e(s)}finally{r.f()}case 6:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}return Object(v.a)(e,[{key:\"negotiate\",value:function(){var e=this;this.peerConnection.createOffer().then((function(n){return e.peerConnection.setLocalDescription(n)})),this.startListener(),this.startUserMedia(),this.sendIceCandidates()}},{key:\"startListener\",value:function(){console.log(\"startListener\"),this.listener=this.newListener()}},{key:\"newListener\",value:function(){console.log(\"newListener\");var e=this;this.socket.onmessage=function(n){var t=JSON.parse(n.data);t.sdp?e.receiveOffer(t):t.candidate&&e.receiveICECandidate(t)}}},{key:\"receiveOffer\",value:function(e){console.log(\"receiveOffer\");var n=this;this.peerConnection.setRemoteDescription(new RTCSessionDescription(e),(function(){n.isOffer()&&n.sendAnswer()}),(function(e){return console.log(e)}))}},{key:\"sendAnswer\",value:function(){console.log(\"sendAnswer\");var e=this;e.peerConnection.createAnswer().then((function(n){return e.send(n),e.peerConnection.setLocalDescription(n)}))}},{key:\"addUserMedia\",value:function(){console.log(\"addUserMedia\"),this.startUserMedia()}},{key:\"receiveICECandidate\",value:function(e){console.log(\"receiveICEcandidate\"),this.peerConnection.addIceCandidate(e)}},{key:\"sendIceCandidates\",value:function(){var e=this;return console.log(\"sendIceCandidate\"),this.peerConnection.onicecandidate=function(n){e.isOpen()&&null!=n.candidate&&e.send(n.candidate)}}},{key:\"send\",value:function(e){console.log(\"send: \",e),this.socket.send(JSON.stringify(e))}},{key:\"isOpen\",value:function(){return this.socket.readyState==WebSocket.OPEN}},{key:\"isOffer\",value:function(){return\"offer\"==this.peerConnection.remoteDescription.type}},{key:\"isAnswer\",value:function(){return\"answer\"==this.peerConnection.remoteDescription.type}}]),e}();function k(){var e=Object(r.useState)(null),n=Object(a.a)(e,2),t=n[0],i=n[1];return Object(r.useEffect)((function(){i(void(new p).negotiate())}),[]),t}function w(){var e=Object(r.useRef)(),n=k();return n&&e.current&&(e.current.srcObject=n,e.current.play()),i.a.createElement(i.a.Fragment,null,i.a.createElement(\"video\",{ref:e,width:\"640\",height:\"480\",autoPlay:!0}))}var C=i.a.createElement(w,null);function y(){return C}var g=document.getElementById(\"root\");o.a.render(i.a.createElement(y,null),g)}},[[10,1,2]]]);","extractedComments":[]}