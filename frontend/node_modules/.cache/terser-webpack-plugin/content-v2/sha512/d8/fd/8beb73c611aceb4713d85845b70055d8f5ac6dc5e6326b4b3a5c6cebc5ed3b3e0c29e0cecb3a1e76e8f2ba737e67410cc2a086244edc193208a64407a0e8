{"map":{"version":3,"sources":["static/js/main.5cc5f68b.chunk.js"],"names":["this","push","14","module","__webpack_exports__","__webpack_require__","r","react","react_default","n","react_dom","react_dom_default","slicedToArray","regenerator","regenerator_default","asyncToGenerator","classCallCheck","createClass","defaultIceServers","iceServers","urls","webRTCRefactor_connHandler","connHandler","Object","socket","WebSocket","window","location","hostname","peerConnection","RTCPeerConnection","listener","video","key","value","_this","createOffer","then","d","setLocalDescription","startListener","addUserMedia","sendIceCandidates","console","log","newListener","onmessage","event","data","message","JSON","parse","spd","receiveOffer","setRemoteDescription","RTCSessionDescription","isOffer","sendAnswer","e","createAnswer","answer","send","_startStream","a","mark","_callee","wrap","_context","prev","next","navigator","mediaDevices","getUserMedia","sent","stop","apply","arguments","startStream","_this2","onicecandidate","isOpen","candidate","payload","stringify","evt","sdp","addIceCandidate","catch","readyState","OPEN","remoteDescription","type","UserMedia","_useState","_useState2","stream","setStream","negotiate","Camera","current","srcObject","play","createElement","Fragment","ref","width","height","autoPlay","App_element","App","rootElement","document","getElementById","render","8","exports"],"mappings":"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"},"code":"(this.webpackJsonpnew=this.webpackJsonpnew||[]).push([[0],{14:function(e,n,t){\"use strict\";t.r(n);var o=t(0),s=t.n(o),i=t(3),r=t.n(i),c=t(7),a=t(1),u=t.n(a),l=t(4),d=t(5),f=t(6);var h={iceServers:[{urls:\"stun:stun.l.google.com:19302\"}]},p=function(){function e(){Object(d.a)(this,e),this.socket=new WebSocket(\"ws://\"+window.location.hostname+\":8050/ws\"),this.peerConnection=new RTCPeerConnection(h),this.listener=null,this.video=null}return Object(f.a)(e,[{key:\"negotiate\",value:function(){var e=this;this.peerConnection.createOffer().then((function(n){return e.peerConnection.setLocalDescription(n)})),this.startListener(),this.addUserMedia(),this.sendIceCandidates()}},{key:\"startListener\",value:function(){console.log(\"startListener\"),this.listener=this.newListener()}},{key:\"newListener\",value:function(){return console.log(\"newListener\"),this.socket.onmessage=function(e){console.log(e.data);var n=JSON.parse(e.data);n.spd&&this.receiveOffer(n)}}},{key:\"receiveOffer\",value:function(e){console.log(\"receoveOffer\"),this.peerConnection.setRemoteDescription(new RTCSessionDescription(e),(function(){this.isOffer()&&this.sendAnswer()}),(function(e){return console.log(e)}))}},{key:\"sendAnswer\",value:function(){console.log(\"sendAnswer\"),this.peerConnection.createAnswer().then((function(e){return this.send(e),this.peerConnection.setLocalDescription(e)}))}},{key:\"addUserMedia\",value:function(){function e(){return(e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0});case 2:this.video=e.sent;case 3:case\"end\":return e.stop()}}),e,this)})))).apply(this,arguments)}console.log(\"addUserMedia\"),function(){e.apply(this,arguments)}()}},{key:\"sendIceCandidates\",value:function(){var e=this;return console.log(\"sendIceCandidate\"),this.peerConnection.onicecandidate=function(n){e.isOpen()&&null!=n.candidate&&e.send(e.socket,n.candidate)}}},{key:\"send\",value:function(e){console.log(\"send: \",e),this.socket.send(JSON.stringify(e))}},{key:\"listen\",value:function(){return this.socket.onmessage=function(e){try{var n=JSON.parse(e.data);console.log(\"receiving: \",n),n.sdp||this.peerConnection.addIceCandidate(n).then(console.log(\"candidate added\")).catch((function(e){return console.log(e)}))}catch(t){console.log(\"error: \",t),console.log(\"message: \")}}}},{key:\"isOpen\",value:function(){return this.socket.readyState==WebSocket.OPEN}},{key:\"isOffer\",value:function(){return\"offer\"==this.peerConnection.remoteDescription.type}},{key:\"isAnswer\",value:function(){return\"answer\"==this.peerConnection.remoteDescription.type}}]),e}();function v(){var e=Object(o.useState)(null),n=Object(c.a)(e,2),t=n[0],s=n[1];return Object(o.useEffect)((function(){s(void(new p).negotiate())}),[]),t}function g(){var e=Object(o.useRef)(),n=v();return n&&e.current&&(e.current.srcObject=n,e.current.play()),s.a.createElement(s.a.Fragment,null,s.a.createElement(\"video\",{ref:e,width:\"640\",height:\"480\",autoPlay:!0}))}var w=s.a.createElement(g,null);function k(){return w}var y=document.getElementById(\"root\");r.a.render(s.a.createElement(k,null),y)},8:function(e,n,t){e.exports=t(14)}},[[8,1,2]]]);","extractedComments":[]}