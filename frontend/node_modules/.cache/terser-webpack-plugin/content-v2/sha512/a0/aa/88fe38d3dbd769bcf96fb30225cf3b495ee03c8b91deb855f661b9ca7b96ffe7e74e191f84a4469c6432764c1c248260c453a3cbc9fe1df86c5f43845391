{"map":{"version":3,"sources":["static/js/main.85f0046e.chunk.js"],"names":["this","push","10","module","exports","__webpack_require__","16","__webpack_exports__","r","react","react_default","n","react_dom","react_dom_default","slicedToArray","regenerator","regenerator_default","createForOfIteratorHelper","asyncToGenerator","classCallCheck","createClass","defaultIceServers","iceServers","urls","webRTCRefactor_connHandler","connHandler","_this","Object","socket","WebSocket","window","location","hostname","peerConnection","RTCPeerConnection","listener","onnegotiationneeded","e","console","log","send","key","value","conn","_startStream","a","mark","_callee","video","_iterator","_step","track","wrap","_context","prev","next","navigator","mediaDevices","getUserMedia","sent","getVideoTracks","s","done","addTrack","err","f","stop","apply","arguments","_this2","onmessage","event","message","JSON","parse","data","sdp","receiveDesc","candidate","receiveICECandidate","payload","stringify","type","setRemoteDescription","RTCSessionDescription","sendAnswer","createAnswer","then","answer","setLocalDescription","_this3","onicecandidate","socketOpen","addIceCandidate","readyState","OPEN","UserMedia","_useState","_useState2","stream","setStream","startUserMedia","sendIceCandidates","startListener","newWebRTCClient","Camera","current","srcObject","play","createElement","Fragment","ref","width","height","autoPlay","App_element","App","rootElement","document","getElementById","render"],"mappings":"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"},"code":"(this.webpackJsonpnew=this.webpackJsonpnew||[]).push([[0],{10:function(e,n,t){e.exports=t(16)},16:function(e,n,t){\"use strict\";t.r(n);var o=t(0),c=t.n(o),r=t(4),s=t.n(r),a=t(9),i=t(2),u=t.n(i),d=t(5),l=t(6),f=t(7),v=t(8);var p={iceServers:[{urls:\"stun:stun.l.google.com:19302\"}]},h=function(){function e(){var n=this;Object(f.a)(this,e),this.socket=new WebSocket(\"ws://\"+window.location.hostname+\":8050/ws\"),this.peerConnection=new RTCPeerConnection(p),this.listener=null,this.peerConnection.onnegotiationneeded=function(e){console.log(\"negotiation needed\"),n.send(\"renegotiate\")}}return Object(v.a)(e,[{key:\"startUserMedia\",value:function(){conn=this,function(){var e=Object(l.a)(u.a.mark((function e(){var n,t,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(\"startUserMedia\"),e.next=3,navigator.mediaDevices.getUserMedia({video:!0});case 3:n=e.sent,t=Object(d.a)(n.getVideoTracks());try{for(t.s();!(o=t.n()).done;)c=o.value,conn.peerConnection.addTrack(c,n),console.log(c)}catch(r){t.e(r)}finally{t.f()}case 6:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}},{key:\"startListener\",value:function(){var e=this;console.log(\"startListener\"),this.socket.onmessage=function(n){var t=JSON.parse(n.data);t.sdp?e.receiveDesc(t):t.candidate&&e.receiveICECandidate(t)}}},{key:\"send\",value:function(e){console.log(\"send: \",e),this.socket.send(JSON.stringify(e))}},{key:\"receiveDesc\",value:function(e){console.log(\"receiveDesc\",e.type),console.log(e.sdp),this.peerConnection.setRemoteDescription(new RTCSessionDescription(e)),\"offer\"==e.type&&this.sendAnswer()}},{key:\"sendAnswer\",value:function(){console.log(\"sendAnswer\");var e=this;e.peerConnection.createAnswer().then((function(n){return e.send(n),e.peerConnection.setLocalDescription(n)}))}},{key:\"sendIceCandidates\",value:function(){var e=this;return console.log(\"sendIceCandidate\"),this.peerConnection.onicecandidate=function(n){e.socketOpen()&&null!=n.candidate&&e.send(n.candidate)}}},{key:\"receiveICECandidate\",value:function(e){console.log(\"receiveICEcandidate: \",e),this.peerConnection.addIceCandidate(e)}},{key:\"socketOpen\",value:function(){return this.socket.readyState==WebSocket.OPEN}}]),e}();function g(){var e=Object(o.useState)(null),n=Object(a.a)(e,2),t=n[0],c=n[1];return Object(o.useEffect)((function(){c(function(){var e=new h;e.startUserMedia(),e.sendIceCandidates(),e.startListener()}())}),[]),t}function k(){var e=Object(o.useRef)(),n=g();return n&&e.current&&(e.current.srcObject=n,e.current.play()),c.a.createElement(c.a.Fragment,null,c.a.createElement(\"video\",{ref:e,width:\"640\",height:\"480\",autoPlay:!0}))}var C=c.a.createElement(k,null);function w(){return C}var y=document.getElementById(\"root\");s.a.render(c.a.createElement(w,null),y)}},[[10,1,2]]]);","extractedComments":[]}