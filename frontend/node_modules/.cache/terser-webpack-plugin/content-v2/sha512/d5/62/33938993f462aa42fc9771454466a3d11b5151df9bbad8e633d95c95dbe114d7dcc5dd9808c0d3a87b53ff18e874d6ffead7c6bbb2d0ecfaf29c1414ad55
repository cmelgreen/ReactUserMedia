{"map":{"version":3,"sources":["static/js/main.b9d80c75.chunk.js"],"names":["this","push","10","module","exports","__webpack_require__","16","__webpack_exports__","r","react","react_default","n","react_dom","react_dom_default","slicedToArray","regenerator","regenerator_default","createForOfIteratorHelper","asyncToGenerator","classCallCheck","createClass","defaultIceServers","iceServers","urls","webRTCRefactor_connHandler","connHandler","_this","Object","socket","WebSocket","window","location","hostname","peerConnection","RTCPeerConnection","listener","onnegotiationneeded","e","send","key","value","payload","JSON","stringify","conn","_startStream","a","mark","_callee","video","_iterator","_step","track","wrap","_context","prev","next","navigator","mediaDevices","getUserMedia","sent","getVideoTracks","s","done","addTrack","err","f","stop","apply","arguments","_this2","onicecandidate","event","readyState","OPEN","candidate","_this3","onmessage","message","parse","data","sdp","setRemoteDescription","RTCSessionDescription","sendAnswer","addIceCandidate","_this4","createAnswer","then","answer","setLocalDescription","UserMedia","_useState","_useState2","stream","setStream","startUserMedia","sendIceCandidates","startListener","newWebRTCClient","Camera","current","srcObject","play","createElement","Fragment","ref","width","height","autoPlay","App_element","App","rootElement","document","getElementById","render"],"mappings":"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"},"code":"(this.webpackJsonpnew=this.webpackJsonpnew||[]).push([[0],{10:function(e,n,t){e.exports=t(16)},16:function(e,n,t){\"use strict\";t.r(n);var a=t(0),r=t.n(a),i=t(4),c=t.n(i),s=t(9),o=t(2),u=t.n(o),d=t(5),l=t(6),f=t(7),v=t(8);var h={iceServers:[{urls:\"stun:stun.l.google.com:19302\"}]},p=function(){function e(){var n=this;Object(f.a)(this,e),this.socket=new WebSocket(\"ws://\"+window.location.hostname+\":8050/ws\"),this.peerConnection=new RTCPeerConnection(h),this.listener=null,this.peerConnection.onnegotiationneeded=function(e){n.send(\"renegotiate\")}}return Object(v.a)(e,[{key:\"send\",value:function(e){this.socket.send(JSON.stringify(e))}},{key:\"startUserMedia\",value:function(){var e=this;(function(){var n=Object(l.a)(u.a.mark((function n(){var t,a,r,i;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,navigator.mediaDevices.getUserMedia({video:!0});case 2:t=n.sent,a=Object(d.a)(t.getVideoTracks());try{for(a.s();!(r=a.n()).done;)i=r.value,e.peerConnection.addTrack(i,t)}catch(c){a.e(c)}finally{a.f()}case 5:case\"end\":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}},{key:\"sendIceCandidates\",value:function(){var e=this;this.peerConnection.onicecandidate=function(n){e.socket.readyState==WebSocket.OPEN&&null!=n.candidate&&e.send(n.candidate)}}},{key:\"startListener\",value:function(){var e=this;this.socket.onmessage=function(n){var t=JSON.parse(n.data);t.sdp?(e.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),e.sendAnswer()):t.candidate&&e.peerConnection.addIceCandidate(t)}}},{key:\"sendAnswer\",value:function(){var e=this;this.peerConnection.createAnswer().then((function(n){e.send(n),e.peerConnection.setLocalDescription(n)}))}}]),e}();function w(){var e=Object(a.useState)(null),n=Object(s.a)(e,2),t=n[0],r=n[1];return Object(a.useEffect)((function(){r(function(){var e=new p;e.startUserMedia(),e.sendIceCandidates(),e.startListener()}())}),[]),t}function k(){var e=Object(a.useRef)(),n=w();return n&&e.current&&(e.current.srcObject=n,e.current.play()),r.a.createElement(r.a.Fragment,null,r.a.createElement(\"video\",{ref:e,width:\"640\",height:\"480\",autoPlay:!0}))}var C=r.a.createElement(k,null);function b(){return C}var m=document.getElementById(\"root\");c.a.render(r.a.createElement(b,null),m)}},[[10,1,2]]]);","extractedComments":[]}