{"map":{"version":3,"sources":["static/js/main.cbff7ffd.chunk.js"],"names":["this","push","14","module","__webpack_exports__","__webpack_require__","r","react","react_default","n","react_dom","react_dom_default","slicedToArray","regenerator","regenerator_default","asyncToGenerator","classCallCheck","createClass","defaultIceServers","iceServers","urls","webRTCRefactor_connHandler","connHandler","Object","socket","WebSocket","window","location","hostname","peerConnection","RTCPeerConnection","key","value","_this","createOffer","then","d","setLocalDescription","receiveOffer","addUserMedia","sendIceCandidates","receiveIceCandidates","listener","newListener","sdp","setRemoteDescription","RTCSessionDescription","message","remoteDescription","type","createAnswer","answer","send","catch","e","console","log","onmessage","payload","JSON","parse","data","_startStream","a","mark","_callee","wrap","_context","prev","next","navigator","mediaDevices","getUserMedia","video","sent","stop","apply","arguments","startStream","_this2","onicecandidate","event","readyState","OPEN","candidate","stringify","evt","addIceCandidate","UserMedia","_useState","_useState2","stream","setStream","conn","negotiate","Camera","current","srcObject","play","createElement","Fragment","ref","width","height","autoPlay","App_element","App","rootElement","document","getElementById","render","8","exports"],"mappings":"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"},"code":"(this.webpackJsonpnew=this.webpackJsonpnew||[]).push([[0],{14:function(e,n,t){\"use strict\";t.r(n);var i=t(0),o=t.n(i),c=t(3),r=t.n(c),s=t(7),a=t(1),u=t.n(a),d=t(4),l=t(5),h=t(6);var f={iceServers:[{urls:\"stun:stun.l.google.com:19302\"}]},p=function(){function e(){Object(l.a)(this,e),this.socket=new WebSocket(\"ws://\"+window.location.hostname+\":8050/ws\"),this.peerConnection=new RTCPeerConnection(f)}return Object(h.a)(e,[{key:\"negotiate\",value:function(){var e=this;this.peerConnection.createOffer().then((function(n){return e.peerConnection.setLocalDescription(n)})).then(this.receiveOffer()).then(this.addUserMedia()).then(this.sendIceCandidates()).then(this.receiveIceCandidates())}},{key:\"receiveOffer\",value:function(){this.listener=newListener(),this.listener().sdp&&this.peerConnection.setRemoteDescription(new RTCSessionDescription(message),(function(){\"offer\"==this.peerConnection.remoteDescription.type&&this.peerConnection.createAnswer().then((function(e){return this.send(e),this.peerConnection.setLocalDescription(e)})).catch((function(e){return console.log(e)}))}),(function(e){return console.log(e)}))}},{key:\"newListener\",value:function(){return this.socket.onmessage=function(e){return message=JSON.parse(e.data),message}}},{key:\"addUserMedia\",value:function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0});case 2:this.video=e.sent;case 3:case\"end\":return e.stop()}}),e,this)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}},{key:\"sendIceCandidates\",value:function(){var e=this;return this.peerConnection.onicecandidate=function(n){e.socket.readyState==WebSocket.OPEN&&null!=n.candidate&&e.send(e.socket,n.candidate)}}},{key:\"send\",value:function(e){this.socket.send(JSON.stringify(e))}},{key:\"listen\",value:function(){return this.socket.onmessage=function(e){try{var n=JSON.parse(e.data);console.log(\"receiving: \",n),n.sdp||this.peerConnection.addIceCandidate(n).then(console.log(\"candidate added\")).catch((function(e){return console.log(e)}))}catch(t){console.log(\"error: \",t),console.log(\"message: \")}}}}]),e}();function v(){var e=Object(i.useState)(null),n=Object(s.a)(e,2),t=n[0],o=n[1];return Object(i.useEffect)((function(){o((conn=new p,void conn.negotiate()))}),[]),t}function g(){var e=Object(i.useRef)(),n=v();return n&&e.current&&(e.current.srcObject=n,e.current.play()),o.a.createElement(o.a.Fragment,null,o.a.createElement(\"video\",{ref:e,width:\"640\",height:\"480\",autoPlay:!0}))}var m=o.a.createElement(g,null);function k(){return m}var w=document.getElementById(\"root\");r.a.render(o.a.createElement(k,null),w)},8:function(e,n,t){e.exports=t(14)}},[[8,1,2]]]);","extractedComments":[]}