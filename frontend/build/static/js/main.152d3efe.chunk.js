(this.webpackJsonpnew=this.webpackJsonpnew||[]).push([[0],{10:function(e,n,t){e.exports=t(16)},16:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),i=t(4),c=t.n(i),s=t(9),o=t(2),u=t.n(o),d=t(5),l=t(6),f=t(7),p=t(8);var v={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},h={video:!0},w=function(){function e(){var n=this;Object(f.a)(this,e),this.socket=new WebSocket("ws://"+window.location.hostname+":8080/ws"),this.peerConnection=new RTCPeerConnection(v),this.source=null,this.listener=null,this.peerConnection.onnegotiationneeded=function(e){n.send("renegotiate")}}return Object(p.a)(e,[{key:"send",value:function(e){this.socket.send(JSON.stringify(e))}},{key:"startUserMedia",value:function(){var e=this;(function(){var n=Object(l.a)(u.a.mark((function n(){var t,r,a,i;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,navigator.mediaDevices.getUserMedia(h);case 2:t=n.sent,r=Object(d.a)(t.getVideoTracks());try{for(r.s();!(a=r.n()).done;)i=a.value,e.peerConnection.addTrack(i,t)}catch(c){r.e(c)}finally{r.f()}case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}},{key:"sendIceCandidates",value:function(){var e=this;this.peerConnection.onicecandidate=function(n){null!=n.candidate&&e.send(n.candidate)}}},{key:"startListener",value:function(){var e=this;this.socket.onmessage=function(n){var t=JSON.parse(n.data);t.sdp?(e.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),e.peerConnection.createAnswer().then((function(n){e.peerConnection.setLocalDescription(n),e.send(n)}))):t.candidate&&e.peerConnection.addIceCandidate(t)}}}]),e}();function m(){var e=Object(r.useState)(null),n=Object(s.a)(e,2),t=n[0];n[1];return Object(r.useEffect)((function(){!function(){var e=new w;e.startUserMedia(),e.sendIceCandidates(),e.startListener()}()}),[]),t}function C(){var e=Object(r.useRef)(),n=m();return n&&e.current&&(e.current.srcObject=n,e.current.play()),a.a.createElement(a.a.Fragment,null,a.a.createElement("video",{ref:e,width:"640",height:"480",muted:"muted",autoPlay:!0}))}var k=a.a.createElement(C,null);function b(){return k}var g=document.getElementById("root");c.a.render(a.a.createElement(b,null),g)}},[[10,1,2]]]);
//# sourceMappingURL=main.152d3efe.chunk.js.map